<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>REACH 2.0 - Patient Journey Demo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'teal': {
                            400: '#2dd4bf',
                            500: '#14b8a6',
                            600: '#0d9488',
                            700: '#0f766e'
                        }
                    }
                }
            }
        }
    </script>
    <style>
        .screen {
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.6s cubic-bezier(0.16, 1, 0.3, 1);
            display: none;
        }
        .screen.active {
            opacity: 1;
            transform: translateY(0);
            display: flex;
        }
        
        /* Enhanced animations */
        @keyframes slideInUp {
            from { opacity: 0; transform: translateY(40px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes fadeInScale {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }
        
        @keyframes pulseGlow {
            0%, 100% { transform: scale(1); box-shadow: 0 0 20px rgba(20, 184, 166, 0.3); }
            50% { transform: scale(1.05); box-shadow: 0 0 40px rgba(20, 184, 166, 0.6); }
        }
        
        @keyframes progressFill {
            from { width: 0%; }
            to { width: 16.67%; }
        }
        
        .animate-slide-in { animation: slideInUp 0.8s ease-out; }
        .animate-fade-scale { animation: fadeInScale 0.6s ease-out; }
        .animate-pulse-glow { animation: pulseGlow 2s infinite; }
        
        .progress-bar {
            background: linear-gradient(90deg, #14b8a6 0%, #14b8a6 16.67%, #e5e7eb 16.67%, #e5e7eb 100%);
            animation: progressFill 1.5s ease-out;
        }
        
        .chat-bubble {
            background: linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%);
            border-radius: 20px 20px 20px 6px;
            border: 1px solid #e5e7eb;
        }
        
        .points-earned {
            background: linear-gradient(135deg, #10b981 0%, #14b8a6 50%, #06b6d4 100%);
            animation: pulseGlow 2s infinite;
        }
        
        /* Perfect Roulette Wheel - Gold Standard */
        .roulette-wheel {
            position: relative;
            width: 18rem;
            height: 18rem;
            border-radius: 50%;
            border: 10px solid #d1d5db;
            background: conic-gradient(from 0deg,
                #ef4444 0deg 36deg,     /* $5 - 10% */
                #22c55e 36deg 72deg,    /* $10 - 10% */
                #ef4444 72deg 108deg,   /* $5 - 10% */
                #22c55e 108deg 144deg,  /* $15 - 10% */
                #ef4444 144deg 180deg,  /* $5 - 10% */
                #22c55e 180deg 216deg,  /* $10 - 10% */
                #ef4444 216deg 252deg,  /* $5 - 10% */
                #8b5cf6 252deg 288deg,  /* $25 - 10% */
                #ef4444 288deg 324deg,  /* $5 - 10% */
                #f59e0b 324deg 360deg   /* $30 - 10% */
            );
            transition: transform 3.5s cubic-bezier(0.23, 1, 0.32, 1);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15), 
                        inset 0 2px 10px rgba(255, 255, 255, 0.1);
        }
        
        .roulette-wheel.spinning {
            box-shadow: 0 0 60px rgba(168, 85, 247, 0.6),
                        0 20px 60px rgba(0, 0, 0, 0.15);
        }
        
        .roulette-numbers {
            position: absolute;
            inset: 0;
            border-radius: 50%;
        }
        
        .roulette-number {
            position: absolute;
            color: white;
            font-weight: bold;
            font-size: 1rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
            width: 2.5rem;
            height: 2.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            top: 50%;
            left: 50%;
        }
        
        /* Precise positioning for perfect alignment */
        .roulette-number:nth-child(1) { transform: translate(-50%, -50%) rotate(18deg) translateY(-6rem) rotate(-18deg); }
        .roulette-number:nth-child(2) { transform: translate(-50%, -50%) rotate(54deg) translateY(-6rem) rotate(-54deg); }
        .roulette-number:nth-child(3) { transform: translate(-50%, -50%) rotate(90deg) translateY(-6rem) rotate(-90deg); }
        .roulette-number:nth-child(4) { transform: translate(-50%, -50%) rotate(126deg) translateY(-6rem) rotate(-126deg); }
        .roulette-number:nth-child(5) { transform: translate(-50%, -50%) rotate(162deg) translateY(-6rem) rotate(-162deg); }
        .roulette-number:nth-child(6) { transform: translate(-50%, -50%) rotate(198deg) translateY(-6rem) rotate(-198deg); }
        .roulette-number:nth-child(7) { transform: translate(-50%, -50%) rotate(234deg) translateY(-6rem) rotate(-234deg); }
        .roulette-number:nth-child(8) { transform: translate(-50%, -50%) rotate(270deg) translateY(-6rem) rotate(-270deg); }
        .roulette-number:nth-child(9) { transform: translate(-50%, -50%) rotate(306deg) translateY(-6rem) rotate(-306deg); }
        .roulette-number:nth-child(10) { transform: translate(-50%, -50%) rotate(342deg) translateY(-6rem) rotate(-342deg); }
        
        /* Enhanced button styles */
        .btn-primary {
            background: linear-gradient(135deg, #14b8a6 0%, #0d9488 100%);
            transform: translateY(0);
            transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(20, 184, 166, 0.4);
        }
        
        .btn-record {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
        }
        
        .btn-record:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(239, 68, 68, 0.4);
        }
        
        .btn-roulette {
            background: linear-gradient(135deg, #a855f7 0%, #ec4899 100%);
        }
        
        .btn-roulette:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(168, 85, 247, 0.4);
        }
        
        /* Win celebration */
        @keyframes celebration {
            0% { transform: scale(1) rotate(0deg); }
            25% { transform: scale(1.1) rotate(-5deg); }
            50% { transform: scale(1.2) rotate(5deg); }
            75% { transform: scale(1.1) rotate(-3deg); }
            100% { transform: scale(1) rotate(0deg); }
        }
        
        .celebrate { animation: celebration 0.6s ease-in-out 3; }
        
        /* Demo branding */
        .demo-badge {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: bold;
            z-index: 1000;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-gray-50 to-gray-100 font-sans">
    <div class="demo-badge">REACH 2.0 Demo</div>
    
    <div class="max-w-sm mx-auto bg-white min-h-screen shadow-2xl relative overflow-hidden">
        
        <!-- Screen 1: Welcome -->
        <section id="welcome" class="screen active flex-col justify-center items-center p-8 text-center h-screen bg-gradient-to-b from-teal-50 to-white">
            <div class="mb-12 animate-fade-scale">
                <div class="w-28 h-28 bg-gradient-to-br from-teal-500 to-teal-600 rounded-full mx-auto mb-8 flex items-center justify-center shadow-2xl animate-pulse-glow">
                    <span class="text-5xl text-white">üåô</span>
                </div>
                <h1 class="text-4xl font-bold text-gray-800 mb-6 leading-tight">Recovery Starts Here</h1>
                <p class="text-gray-600 text-xl leading-relaxed">Scan your first test, earn your first reward</p>
            </div>
            <button onclick="navigateTo('intake')" class="w-full btn-primary text-white py-5 px-8 rounded-2xl text-xl font-bold shadow-xl">
                Begin in ED
            </button>
        </section>

        <!-- Screen 2: Quick Intake -->
        <section id="intake" class="screen flex-col p-8 h-screen bg-gradient-to-b from-blue-50 to-white">
            <div class="mb-8 animate-slide-in">
                <button onclick="navigateTo('welcome')" class="text-teal-500 mb-6 flex items-center text-lg">
                    <span class="mr-3">‚Üê</span> Back
                </button>
                <h2 class="text-3xl font-bold text-gray-800 mb-3">Quick Intake</h2>
                <p class="text-gray-600 text-lg">Just a few details to get started</p>
            </div>
            
            <div class="flex-1 space-y-6 mb-8 animate-slide-in">
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-3">Patient Name</label>
                    <input type="text" value="Sarah Johnson" class="w-full p-4 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition-all bg-gray-50" placeholder="Enter full name">
                </div>
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-3">Medicaid ID</label>
                    <input type="text" value="MCD789012" class="w-full p-4 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition-all bg-gray-50" placeholder="Enter Medicaid ID">
                </div>
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-3">Ethnicity</label>
                    <select class="w-full p-4 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition-all bg-gray-50">
                        <option>Not Hispanic or Latino</option>
                        <option>Hispanic or Latino</option>
                        <option>Prefer not to answer</option>
                    </select>
                </div>
            </div>
            
            <button onclick="navigateTo('record')" class="w-full btn-primary text-white py-5 px-8 rounded-2xl text-xl font-bold shadow-xl">
                Continue
            </button>
        </section>

        <!-- Screen 3: Record Test -->
        <section id="record" class="screen flex-col justify-center items-center p-8 text-center h-screen bg-gradient-to-b from-red-50 to-white">
            <div class="mb-12 animate-fade-scale">
                <div class="w-40 h-40 bg-gradient-to-br from-gray-100 to-gray-200 rounded-full mx-auto mb-8 flex items-center justify-center border-4 border-dashed border-gray-400 animate-pulse-glow">
                    <span class="text-6xl">üì∑</span>
                </div>
                <h2 class="text-3xl font-bold text-gray-800 mb-4">Record Your Test</h2>
                <p class="text-gray-600 text-xl">Tap to record saliva test</p>
            </div>
            <button onclick="startRecording()" id="recordBtn" class="w-full btn-record text-white py-5 px-8 rounded-2xl text-xl font-bold shadow-xl">
                Start Recording
            </button>
        </section>

        <!-- Screen 4: Success -->
        <section id="success" class="screen flex-col justify-center items-center p-8 text-center h-screen bg-gradient-to-b from-green-50 to-white">
            <div class="mb-12 animate-fade-scale">
                <div class="text-9xl mb-8 celebrate">üéâ</div>
                <h2 class="text-4xl font-bold text-gray-800 mb-6">Nice work!</h2>
                <div class="points-earned text-white py-4 px-8 rounded-full inline-block mb-6 shadow-xl">
                    <span class="font-bold text-2xl">You earned 10 points!</span>
                </div>
                <p class="text-gray-600 text-lg">Keep up the great progress</p>
            </div>
            <button onclick="navigateTo('wallet')" class="w-full btn-primary text-white py-5 px-8 rounded-2xl text-xl font-bold shadow-xl">
                See Wallet
            </button>
        </section>

        <!-- Screen 5: Wallet -->
        <section id="wallet" class="screen flex-col p-8 h-screen bg-gradient-to-b from-purple-50 to-white">
            <div class="mb-8 animate-slide-in">
                <button onclick="navigateTo('success')" class="text-teal-500 mb-6 flex items-center text-lg">
                    <span class="mr-3">‚Üê</span> Back
                </button>
                <h2 class="text-3xl font-bold text-gray-800 mb-3">Your Reward Wallet</h2>
                <p class="text-gray-600 text-lg">Track your progress and earnings</p>
            </div>
            
            <div class="bg-gradient-to-br from-teal-500 to-teal-600 rounded-2xl p-8 text-white mb-8 shadow-xl animate-slide-in">
                <div class="flex justify-between items-center mb-6">
                    <span class="text-xl">Total Points</span>
                    <span class="text-5xl font-bold">35</span>
                </div>
                <div class="mb-6">
                    <div class="flex justify-between text-sm mb-3">
                        <span>Progress Streak</span>
                        <span>2 / 12</span>
                    </div>
                    <div class="w-full bg-teal-700 rounded-full h-4">
                        <div class="bg-white rounded-full h-4 progress-bar shadow-inner"></div>
                    </div>
                </div>
                <div class="text-center">
                    <button onclick="openRoulette()" class="bg-white text-teal-600 px-8 py-3 rounded-full font-bold hover:bg-gray-100 transition-all transform hover:scale-105 shadow-lg">
                        üé∞ Spin Roulette (25 pts)
                    </button>
                </div>
            </div>

            <div class="flex-1 space-y-4 mb-8 animate-slide-in">
                <div class="bg-gradient-to-r from-green-50 to-green-100 rounded-xl p-5 border border-green-200 shadow-lg">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            <span class="text-3xl mr-4">‚úÖ</span>
                            <div>
                                <p class="font-bold text-green-800 text-lg">Test Complete</p>
                                <p class="text-sm text-green-600">Just now</p>
                            </div>
                        </div>
                        <span class="text-green-600 font-bold text-xl">+10</span>
                    </div>
                </div>
                <div class="bg-gradient-to-r from-blue-50 to-blue-100 rounded-xl p-5 border border-blue-200 shadow-lg">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            <span class="text-3xl mr-4">üéÅ</span>
                            <div>
                                <p class="font-bold text-blue-800 text-lg">Welcome Bonus</p>
                                <p class="text-sm text-blue-600">Earlier today</p>
                            </div>
                        </div>
                        <span class="text-blue-600 font-bold text-xl">+25</span>
                    </div>
                </div>
            </div>
            
            <button onclick="navigateTo('chat')" class="w-full btn-primary text-white py-5 px-8 rounded-2xl text-xl font-bold shadow-xl">
                Go to Chat
            </button>
        </section>

        <!-- Screen 6: Support Group -->
        <section id="chat" class="screen flex-col p-8 h-screen bg-gradient-to-b from-indigo-50 to-white">
            <div class="mb-8 animate-slide-in">
                <button onclick="navigateTo('wallet')" class="text-teal-500 mb-6 flex items-center text-lg">
                    <span class="mr-3">‚Üê</span> Back
                </button>
                <h2 class="text-3xl font-bold text-gray-800 mb-3">Support Group</h2>
                <p class="text-gray-600 text-lg">Connect with your care team</p>
            </div>
            
            <div class="flex-1 space-y-6 mb-8 animate-slide-in">
                <div class="chat-bubble p-6 shadow-lg">
                    <div class="flex items-start space-x-4">
                        <div class="w-12 h-12 bg-gradient-to-br from-teal-500 to-teal-600 rounded-full flex items-center justify-center text-white font-bold text-lg shadow-lg">
                            C
                        </div>
                        <div>
                            <p class="text-sm text-gray-500 mb-2 font-semibold">Cam (MSW)</p>
                            <p class="text-gray-800 text-lg leading-relaxed">Great first test! You're doing amazing. Keep up the excellent work! üí™</p>
                        </div>
                    </div>
                </div>
                
                <div class="chat-bubble p-6 shadow-lg">
                    <div class="flex items-start space-x-4">
                        <div class="w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full flex items-center justify-center text-white font-bold text-lg shadow-lg">
                            A
                        </div>
                        <div>
                            <p class="text-sm text-gray-500 mb-2 font-semibold">Alex (Peer)</p>
                            <p class="text-gray-800 text-lg leading-relaxed">üéâ Welcome to the team! So proud of you for starting this journey!</p>
                        </div>
                    </div>
                </div>
                
                <div class="text-center py-8">
                    <p class="text-gray-500 text-lg font-medium">Your support team is here for you 24/7</p>
                </div>
            </div>
            
            <button onclick="navigateTo('mentor')" class="w-full btn-primary text-white py-5 px-8 rounded-2xl text-xl font-bold shadow-xl">
                Next Steps
            </button>
        </section>

        <!-- Screen 7: Peer Mentor Path -->
        <section id="mentor" class="screen flex-col p-8 h-screen bg-gradient-to-b from-yellow-50 to-white">
            <div class="mb-8 animate-slide-in">
                <button onclick="navigateTo('chat')" class="text-teal-500 mb-6 flex items-center text-lg">
                    <span class="mr-3">‚Üê</span> Back
                </button>
                <h2 class="text-3xl font-bold text-gray-800 mb-3">Peer Mentor Path</h2>
                <p class="text-gray-600 text-lg">Your journey to helping others</p>
            </div>
            
            <div class="flex-1 space-y-6 mb-8 animate-slide-in">
                <div class="flex items-center p-6 bg-gradient-to-r from-green-50 to-green-100 border border-green-200 rounded-2xl shadow-lg">
                    <span class="text-4xl mr-6">‚úÖ</span>
                    <div>
                        <p class="font-bold text-green-800 text-xl">8 negative tests</p>
                        <p class="text-green-600">Completed successfully</p>
                    </div>
                </div>
                
                <div class="flex items-center p-6 bg-gradient-to-r from-yellow-50 to-yellow-100 border border-yellow-200 rounded-2xl shadow-lg">
                    <span class="text-4xl mr-6">üïë</span>
                    <div>
                        <p class="font-bold text-yellow-800 text-xl">Training scheduled</p>
                        <p class="text-yellow-600">Next week - Calendar invite sent</p>
                    </div>
                </div>
                
                <div class="flex items-center p-6 bg-gradient-to-r from-gray-50 to-gray-100 border border-gray-200 rounded-2xl shadow-lg">
                    <span class="text-4xl mr-6">üöÄ</span>
                    <div>
                        <p class="font-bold text-gray-600 text-xl">Practicum</p>
                        <p class="text-gray-500">After training completion</p>
                    </div>
                </div>
            </div>
            
            <button onclick="navigateTo('exit')" class="w-full btn-primary text-white py-5 px-8 rounded-2xl text-xl font-bold shadow-xl">
                Finish
            </button>
        </section>

        <!-- Screen 8: Exit -->
        <section id="exit" class="screen flex-col justify-center items-center p-8 text-center h-screen bg-gradient-to-b from-teal-50 to-white">
            <div class="mb-12 animate-fade-scale">
                <div class="w-28 h-28 bg-gradient-to-br from-teal-500 to-teal-600 rounded-full mx-auto mb-8 flex items-center justify-center shadow-2xl animate-pulse-glow">
                    <span class="text-5xl text-white">üåü</span>
                </div>
                <h2 class="text-4xl font-bold text-gray-800 mb-8 leading-tight">Ready to change your story?</h2>
                <p class="text-gray-600 text-xl leading-relaxed mb-8">Tap Join and we'll text your first test.</p>
                <div class="text-lg text-gray-500 mb-6 space-y-2">
                    <p>‚úì 24/7 support team</p>
                    <p>‚úì Real cash rewards</p>
                    <p>‚úì Your personalized recovery plan</p>
                </div>
            </div>
            <button onclick="showJoinSuccess()" class="w-full bg-gradient-to-r from-teal-500 to-teal-600 text-white py-5 px-8 rounded-2xl text-xl font-bold shadow-xl transform hover:scale-105 transition-all">
                Join REACH 2.0
            </button>
        </section>

        <!-- Roulette Modal - Gold Standard -->
        <div id="rouletteModal" class="fixed inset-0 bg-black bg-opacity-60 hidden z-50 flex items-center justify-center p-6">
            <div class="bg-white rounded-3xl p-8 text-center max-w-md w-full shadow-2xl">
                <h2 class="text-3xl font-bold text-gray-800 mb-4">Reward Roulette!</h2>
                <p class="text-gray-600 mb-8 text-lg">Cost: 25 points</p>
                
                <div class="relative mb-10">
                    <div id="rouletteWheel" class="roulette-wheel mx-auto">
                        <div class="absolute inset-0 flex items-center justify-center">
                            <div class="w-6 h-6 bg-white rounded-full z-10 shadow-lg border-2 border-gray-300"></div>
                        </div>
                        <div class="roulette-numbers">
                            <div class="roulette-number">$5</div>
                            <div class="roulette-number">$10</div>
                            <div class="roulette-number">$5</div>
                            <div class="roulette-number">$15</div>
                            <div class="roulette-number">$5</div>
                            <div class="roulette-number">$10</div>
                            <div class="roulette-number">$5</div>
                            <div class="roulette-number">$25</div>
                            <div class="roulette-number">$5</div>
                            <div class="roulette-number">$30</div>
                        </div>
                    </div>
                    <div class="absolute top-0 left-1/2 transform -translate-x-1/2 -translate-y-2 z-20">
                        <div class="w-0 h-0 border-l-6 border-r-6 border-b-10 border-l-transparent border-r-transparent border-b-gray-800 shadow-lg"></div>
                    </div>
                </div>
                
                <button onclick="spinRoulette()" id="spinButton" class="w-full btn-roulette text-white py-5 rounded-2xl text-xl font-bold mb-4 shadow-xl">
                    üé∞ Tap to spin now! üé∞
                </button>
                
                <button onclick="closeRoulette()" class="w-full border-2 border-gray-300 text-gray-700 py-4 rounded-2xl font-bold hover:bg-gray-50 transition-all">
                    Cancel
                </button>
                
                <div id="spinResult" class="hidden mt-8 text-center">
                    <div class="text-8xl mb-4 celebrate">üéä</div>
                    <h3 class="text-4xl font-bold text-green-600 mb-4 celebrate" id="winAmount">YOU WON $15!</h3>
                    <p class="text-gray-600 mb-6 text-lg">Money added to your account!</p>
                    <button onclick="closeRoulette()" class="bg-gradient-to-r from-teal-500 to-teal-600 text-white px-8 py-4 rounded-xl font-bold text-lg shadow-xl">
                        Collect Winnings
                    </button>
                </div>
            </div>
        </div>

        <!-- Join Success Modal -->
        <div id="joinModal" class="fixed inset-0 bg-black bg-opacity-60 hidden z-50 flex items-center justify-center p-6">
            <div class="bg-white rounded-3xl p-10 text-center max-w-sm w-full shadow-2xl">
                <div class="text-8xl mb-6 celebrate">üéâ</div>
                <h3 class="text-3xl font-bold text-gray-800 mb-6">Welcome to REACH 2.0!</h3>
                <p class="text-gray-600 mb-8 text-lg leading-relaxed">You'll receive your first test kit and instructions via text within 24 hours.</p>
                <button onclick="restartDemo()" class="w-full btn-primary text-white py-4 px-8 rounded-xl font-bold text-lg shadow-xl">
                    Experience Demo Again
                </button>
            </div>
        </div>
    </div>

    <script>
        // Enhanced demo state
        let currentPoints = 35;
        let demoStep = 0;
        
        // Analytics for demo tracking
        function logDemoEvent(action, screen, details = {}) {
            const event = {
                timestamp: new Date().toISOString(),
                action: action,
                screen: screen,
                details: details,
                demoStep: demoStep++,
                sessionId: getDemoSessionId()
            };
            console.log('[REACH 2.0 Demo Analytics]', event);
        }

        function getDemoSessionId() {
            let sessionId = sessionStorage.getItem('reach-demo-session');
            if (!sessionId) {
                sessionId = 'demo-' + Date.now() + '-' + Math.random().toString(36).substr(2, 9);
                sessionStorage.setItem('reach-demo-session', sessionId);
            }
            return sessionId;
        }

        // Enhanced navigation with staging
        function navigateTo(screenId) {
            const currentScreen = document.querySelector('.screen.active');
            const nextScreen = document.getElementById(screenId);
            
            logDemoEvent('NAVIGATE', screenId.toUpperCase(), {
                from: currentScreen.id,
                to: screenId
            });
            
            // Smooth staging transition
            currentScreen.style.transform = 'translateY(-20px)';
            currentScreen.style.opacity = '0';
            
            setTimeout(() => {
                currentScreen.classList.remove('active');
                nextScreen.classList.add('active');
                nextScreen.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }, 300);
        }

        // Enhanced recording simulation
        function startRecording() {
            const btn = document.getElementById('recordBtn');
            
            logDemoEvent('RECORDING_STARTED', 'RECORD');
            
            btn.textContent = 'Recording...';
            btn.classList.add('animate-pulse');
            btn.disabled = true;
            
            // Realistic recording simulation
            setTimeout(() => {
                btn.textContent = 'Processing Results...';
                setTimeout(() => {
                    btn.textContent = 'Test Complete!';
                    setTimeout(() => {
                        logDemoEvent('RECORDING_COMPLETE', 'RECORD');
                        navigateTo('success');
                    }, 800);
                }, 2000);
            }, 3000);
        }

        // Perfect Roulette - Gold Standard Implementation
        function openRoulette() {
            document.getElementById('rouletteModal').classList.remove('hidden');
            logDemoEvent('ROULETTE_OPENED', 'WALLET');
        }

        function spinRoulette() {
            const button = document.getElementById('spinButton');
            const wheel = document.getElementById('rouletteWheel');
            
            button.disabled = true;
            button.textContent = 'üé∞ SPINNING... üé∞';
            wheel.classList.add('spinning');
            
            logDemoEvent('ROULETTE_SPIN_STARTED', 'WALLET');
            
            // Define wheel sections with EXACT angles (Gold Standard)
            const wheelSections = [
                { angle: 18, prize: 5 },   // $5 section 1
                { angle: 54, prize: 10 },  // $10 section 1
                { angle: 90, prize: 5 },   // $5 section 2
                { angle: 126, prize: 15 }, // $15 section
                { angle: 162, prize: 5 },  // $5 section 3
                { angle: 198, prize: 10 }, // $10 section 2
                { angle: 234, prize: 5 },  // $5 section 4
                { angle: 270, prize: 25 }, // $25 section
                { angle: 306, prize: 5 },  // $5 section 5
                { angle: 342, prize: 30 }  // $30 section
            ];
            
            // Determine winning section with proper probabilities
            const rand = Math.random();
            let winningSection;
            
            if (rand < 0.1) {
                winningSection = wheelSections[9]; // $30 - 10%
            } else if (rand < 0.2) {
                winningSection = wheelSections[7]; // $25 - 10%
            } else if (rand < 0.3) {
                winningSection = wheelSections[3]; // $15 - 10%
            } else if (rand < 0.5) {
                const tenSections = [wheelSections[1], wheelSections[5]]; // $10 - 20%
                winningSection = tenSections[Math.floor(Math.random() * tenSections.length)];
            } else {
                const fiveSections = [wheelSections[0], wheelSections[2], wheelSections[4], wheelSections[6], wheelSections[8]]; // $5 - 50%
                winningSection = fiveSections[Math.floor(Math.random() * fiveSections.length)];
            }
            
            // Calculate PERFECT final rotation
            const baseRotations = 2160; // 6 full spins for dramatic effect
            const targetAngle = 360 - winningSection.angle; // Bring winning section to pointer
            const finalRotation = baseRotations + targetAngle;
            
            // Execute pixel-perfect spin
            wheel.style.transform = `rotate(${finalRotation}deg)`;
            
            // Show results with perfect timing
            setTimeout(() => {
                currentPoints -= 25;
                document.getElementById('winAmount').textContent = `YOU WON $${winningSection.prize}!`;
                document.getElementById('spinResult').classList.remove('hidden');
                button.classList.add('hidden');
                wheel.classList.remove('spinning');
                
                // Haptic feedback for mobile
                if (navigator.vibrate) {
                    navigator.vibrate([100, 50, 100, 50, 200]);
                }
                
                logDemoEvent(`ROULETTE_WON_$${winningSection.prize}`, 'WALLET', {
                    winAmount: winningSection.prize,
                    targetAngle: winningSection.angle,
                    finalRotation: finalRotation,
                    precision: 'perfect'
                });
            }, 3500);
        }

        function closeRoulette() {
            document.getElementById('rouletteModal').classList.add('hidden');
            document.getElementById('spinResult').classList.add('hidden');
            document.getElementById('spinButton').classList.remove('hidden');
            document.getElementById('spinButton').disabled = false;
            document.getElementById('spinButton').textContent = 'üé∞ Tap to spin now! üé∞';

            // Reset wheel to starting position
            const wheel = document.getElementById('rouletteWheel');
            wheel.classList.remove('spinning');
            wheel.style.transform = 'rotate(0deg)';
            wheel.style.transition = 'none';
            setTimeout(() => {
                wheel.style.transition = 'transform 3.5s cubic-bezier(0.23, 1, 0.32, 1)';
            }, 100);
        }

        // Join success flow
        function showJoinSuccess() {
            logDemoEvent('JOIN_PROGRAM', 'EXIT');
            document.getElementById('joinModal').classList.remove('hidden');
        }

        function restartDemo() {
            logDemoEvent('RESTART_DEMO', 'MODAL');
            document.getElementById('joinModal').classList.add('hidden');
            
            // Reset demo state
            currentPoints = 35;
            demoStep = 0;
            
            // Reset record button
            const recordBtn = document.getElementById('recordBtn');
            recordBtn.textContent = 'Start Recording';
            recordBtn.classList.remove('animate-pulse');
            recordBtn.disabled = false;
            
            navigateTo('welcome');
        }

        // Enhanced interaction tracking
        document.addEventListener('click', function(e) {
            if (e.target.tagName === 'BUTTON') {
                const currentScreen = document.querySelector('.screen.active');
                const buttonText = e.target.textContent.trim();
                
                logDemoEvent('BUTTON_INTERACTION', currentScreen.id.toUpperCase(), {
                    buttonText: buttonText,
                    element: e.target.className
                });
            }
        });

        // Demo initialization
        document.addEventListener('DOMContentLoaded', function() {
            logDemoEvent('DEMO_LOADED', 'WELCOME');
            console.log('üåô REACH 2.0 Patient Journey Demo - Analytics Active');
            console.log('üéØ Gold Standard Roulette Wheel - Precision Mode');
            
            // Add demo intro delay
            setTimeout(() => {
                document.querySelector('#welcome').style.opacity = '1';
                document.querySelector('#welcome').style.transform = 'translateY(0)';
            }, 500);
        });

        // Track demo completion
        window.addEventListener('beforeunload', function() {
            logDemoEvent('DEMO_SESSION_END', 'APP', {
                totalSteps: demoStep,
                duration: Date.now() - parseInt(getDemoSessionId().split('-')[1])
            });
        });
    </script>
</body>
</html>
